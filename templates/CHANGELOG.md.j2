{% macro add_emoji(commit_type) %}{% if commit_type == "feature" %}âœ¨{% elif commit_type == "fix" %}ðŸ›{% elif commit_type == "documentation" %}ðŸ“–{% elif commit_type == "style" %}ðŸŽ¨{% elif commit_type == "refactor" %}â™»ï¸{% elif commit_type == "test" %}âœ…{% elif commit_type == "chore" %}ðŸš€{% elif commit_type == "performance" %}âš¡ï¸{% elif commit_type == "ci" %}ðŸ‘·â€â™‚ï¸{% elif commit_type == "build" %}ðŸ—{% elif commit_type == "breaking" %}ðŸ’¥{% elif commit_type == "unknown" %}ðŸ¤·â€â™‚ï¸{% elif commit_type == "revert" %}âª{% else %}ðŸ¤·â€â™‚ï¸{% endif %}{% endmacro %}
{% macro commit_scope(commit_summary) %}{{ commit_summary.split(":")[0] }}{% endmacro %}
{% macro commit_content(commit_summary) %}{{ commit_summary.split(":")[1] }}{% endmacro %}
{% set order = ["breaking", "feature", "fix", "documentation", "style", "refactor", "performance", "test", "build", "ci", "chore", "revert"] %}
# CHANGELOG
{% set order = ["breaking", "feature", "fix", "documentation", "style", "refactor", "performance", "test", "build", "ci", "chore", "revert"] %}
{% if context.history.unreleased | length > 0 %}
{# UNRELEASED #}
## Unreleased
{%- for type_ in order %}
{%- if type_ in context.history.unreleased %}
### {{ add_emoji(type_) }} {{ type_ | capitalize }}
{% for commit in context.history.unreleased[type_] %}
{% set scope = commit_scope(commit.commit.summary).split("(")[1] | replace(")", "") | default ("", true) %}
- {% if scope %}\[**{{ scope }}**\]{%endif%}{{ commit_content(commit.commit.summary) }} [\@{{ commit.commit.author.name }}](mailto:{{commit.commit.author.email}})
{% endfor %}{% endif %}{% endfor %}{% endif %}

{# RELEASED #}
{% for version, release in context.history.released.items() %}
## {{ version.as_tag() }} ({{ release.tagged_date.strftime("%Y-%m-%d") }})
{%- for type_ in order %}
{%- if type_ in release["elements"] %}
### {{ add_emoji(type_) }} {{ type_ | capitalize }}
{% for commit in release["elements"][type_] %}
{% set scope = commit_scope(commit.commit.summary).split("(")[1] | replace(")", "") | default ("", true) %}
- {% if scope %}\[**{{ scope }}**\]{%endif%}{{ commit_content(commit.commit.summary) }} [\@{{ commit.commit.author.name }}](mailto:{{commit.commit.author.email}})
{% endfor %}{% endif %}{% endfor %}{% endfor %}
